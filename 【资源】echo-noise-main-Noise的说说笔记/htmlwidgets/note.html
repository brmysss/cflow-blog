<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Noise说说笔记</title>
    <link rel="stylesheet" href="./css/APlayer.min.css">
    <link rel="stylesheet" href="./css/styles.css">
    <link rel="stylesheet" href="./css/waline.css">
    <base target="_blank">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="https://unpkg.com/medium-zoom/dist/medium-zoom.min.js"></script>
    <!-- 添加代码高亮支持 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-python.min.js"></script>
    <!-- 预加载关键资源 -->
    <link rel="preload" href="./js/note.js" as="script">
    <link rel="preload" href="./css/styles.css" as="style">
    
    
    <!-- 按需加载非关键资源 -->
    <link rel="stylesheet" href="./css/APlayer.min.css" media="print" onload="this.media='all'">
</head>
<body>
    <div id="note">
        <div class="note-header">
            <div class="search-container">
                <input type="text" id="tag-search" placeholder="搜索标签 #..." />
                <button id="search-btn" target="_self">搜索</button>
            </div>
        </div>
        <div class="note-container">
            <div class="loading-wrapper">加载中...</div>
        </div>
    </div>
    
    <!-- 确保所有脚本在内容加载后执行 -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="./js/jquery-3.2.1.js"></script>
    <script src="./js/APlayer.min.js"></script>
    <script src="./js/Meting.min.js"></script>
    <script>
        window.note = {
            host: 'https://note.noisework.cn',
            limit: '10',
            domId: '#note',
            commentServer: 'https://app-production-80c1.up.railway.app',
            sourceName: '「说说笔记」',
            loadingTimeout: 10000  // 添加加载超时时间配置
        };
        
        // 添加加载超时处理
        setTimeout(() => {
            const loadingWrapper = document.querySelector('.loading-wrapper');
            if (loadingWrapper && loadingWrapper.style.display !== 'none') {
                loadingWrapper.textContent = '加载失败，请刷新重试';
            }
        }, window.note.loadingTimeout);
        
        marked.setOptions({
            breaks: true,
            gfm: true,
        });
    </script>
    <script src="./js/note.js"></script>
    <script>
        // 确保所有链接在新标签页打开
        document.addEventListener('DOMContentLoaded', function() {
            document.addEventListener('click', function(e) {
                const target = e.target.closest('a');
                if (target && !target.hasAttribute('target')) {
                    target.setAttribute('target', '_blank');
                }
            });
        });
    </script>
</body>
</html>